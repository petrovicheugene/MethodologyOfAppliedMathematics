(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16058,        351]
NotebookOptionsPosition[     15735,        335]
NotebookOutlinePosition[     16081,        350]
CellTagsIndexPosition[     16038,        347]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"S", "[", "xList_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"resList", ",", 
         RowBox[{"x1", "=", 
          RowBox[{
          "xList", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         ",", 
         RowBox[{"x2", "=", 
          RowBox[{
          "xList", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         ",", 
         RowBox[{"x3", "=", 
          RowBox[{
          "xList", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         ",", 
         RowBox[{"x4", "=", 
          RowBox[{
          "xList", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"resList", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"resList", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "0.33824"}], "*", "x2"}], "+", 
           RowBox[{"0.602941", "*", "x3"}], "-", 
           RowBox[{"0.08824", "*", "x4"}], "+", "0.985294"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"resList", ",", 
          RowBox[{
           RowBox[{"0.204545", "*", "x1"}], "-", 
           RowBox[{"0.375", "*", "x3"}], "-", "1"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"resList", ",", 
          RowBox[{
           RowBox[{"0.114286", "*", "x1"}], "+", 
           RowBox[{"0.304762", "*", "x2"}], "+", 
           RowBox[{"0.638095", "*", "x4"}], "-", "0.17143"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"resList", ",", 
          RowBox[{
           RowBox[{"0.044643", "*", "x1"}], "-", 
           RowBox[{"0.09821", "*", "x2"}], "+", 
           RowBox[{"0.080357", "*", "x3"}], "+", "1.285714"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "resList", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Er", "[", 
      RowBox[{"curList_List", ",", "prevList_List", ",", "q_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"er", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"er", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"Length", "[", "curList", "]"}]}], ",", 
          RowBox[{"++", "j"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"er", ",", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "q"}], ")"}], "/", "q"}], "]"}], "*", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{
                "curList", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], "-", 
                RowBox[{
                "prevList", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "er", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IterationMethod", "[", 
      RowBox[{"x0List_List", ",", "eps_", ",", "q_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "iterationList", ",", "curResList", ",", "prevResList", ",", "row", 
         ",", "eList", ",", "itCount", ",", "goOn", ",", "i"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iterationList", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"iterationList", ",", 
          RowBox[{"{", 
           RowBox[{
           "N", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "e1", ",", 
            "e2", ",", "e3", ",", "e4"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"itCount", "=", "0"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"row", "=", "x0List"}], ";", "\[IndentingNewLine]", 
        RowBox[{"PrependTo", "[", 
         RowBox[{"row", ",", 
          RowBox[{"itCount", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"iterationList", ",", "row"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"prevResList", "=", "x0List"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"curResList", "=", 
            RowBox[{"S", "[", "prevResList", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"eList", "=", 
            RowBox[{"Er", "[", 
             RowBox[{"curResList", ",", "prevResList", ",", "q"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"goOn", "=", "False"}], ";", "\[IndentingNewLine]", 
           RowBox[{"row", "=", "curResList"}], ";", "\[IndentingNewLine]", 
           RowBox[{"PrependTo", "[", 
            RowBox[{"row", ",", 
             RowBox[{"itCount", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", 
              RowBox[{"Length", "[", "eList", "]"}]}], ",", 
             RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"row", ",", 
                RowBox[{
                "eList", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "eList", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ">", "eps"}], ",", 
                RowBox[{
                 RowBox[{"goOn", "=", "True"}], ";"}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"iterationList", ",", "row"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", "goOn"}], ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"prevResList", "=", "curResList"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", "30", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "iterationList", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IterationMethod", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.985294", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "0.17143"}], ",", "1.285714"}], "}"}], ",", "0.001", ",",
       "1.057"}], "]"}], "//", "TableForm"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.807282316664708*^9, 3.8072826317953057`*^9}, {
   3.8072826674339437`*^9, 3.8072827115579157`*^9}, {3.8072827433614287`*^9, 
   3.8072827896387024`*^9}, {3.8072828662997327`*^9, 
   3.8072830096585703`*^9}, {3.8072830433690867`*^9, 
   3.8072832094909725`*^9}, {3.807283243355237*^9, 3.8072833558871984`*^9}, 
   3.8072833930447793`*^9, {3.8072834367551584`*^9, 3.8072836078860784`*^9}, {
   3.807283699295017*^9, 3.8072837063767*^9}, 3.807283783536331*^9, {
   3.8072838425658774`*^9, 3.807283868196348*^9}, {3.80728393609219*^9, 
   3.807283948859417*^9}, {3.807283984329836*^9, 3.807283988734258*^9}, {
   3.8072840266329117`*^9, 3.807284029505186*^9}, {3.8072840616864777`*^9, 
   3.8072843885676403`*^9}, {3.8072845257746906`*^9, 3.807284557476746*^9}, {
   3.807284684713157*^9, 3.8072846861152906`*^9}, {3.8072847162623506`*^9, 
   3.8072847900446024`*^9}, {3.8072848443638372`*^9, 
   3.8072850800346737`*^9}, {3.8072851316556463`*^9, 
   3.8072853712370443`*^9}, {3.8072854351802053`*^9, 3.807285598566086*^9}, {
   3.8072856695319223`*^9, 3.8072857061584573`*^9}, {3.8072859461359067`*^9, 
   3.80728622797369*^9}, {3.8072862613249044`*^9, 3.8072863223839893`*^9}, {
   3.8072863621219673`*^9, 3.8072864212126617`*^9}, {3.8072877930352564`*^9, 
   3.807287837047496*^9}, {3.807287872498912*^9, 3.807287922453867*^9}, {
   3.807288002852768*^9, 3.8072880978123302`*^9}, {3.807288155634097*^9, 
   3.807288189004312*^9}, {3.8072882234136267`*^9, 3.807288248539048*^9}, {
   3.807288340396104*^9, 3.8072883548074923`*^9}, {3.80728839444131*^9, 
   3.8072884503449755`*^9}, {3.8072884873415413`*^9, 
   3.8072885851873293`*^9}, {3.8072886372435007`*^9, 3.807288646524696*^9}, {
   3.8072886815642033`*^9, 3.807288747622573*^9}, {3.8072888590547743`*^9, 
   3.80728904716753*^9}, {3.8072891009929075`*^9, 3.8072892834207935`*^9}, {
   3.8072893501263657`*^9, 3.8072894534944572`*^9}, {3.8072894855215454`*^9, 
   3.8072895638142624`*^9}, {3.807289905268282*^9, 3.807289936530477*^9}, {
   3.8072900195694776`*^9, 3.807290066175968*^9}, {3.8072902466253524`*^9, 
   3.8072903501886687`*^9}, {3.8072903899184976`*^9, 3.807290582575657*^9}, {
   3.807290638141013*^9, 3.807290647736935*^9}, {3.807290690270203*^9, 
   3.807290702735403*^9}, 3.807290738174821*^9, {3.807290845019407*^9, 
   3.807291040517242*^9}, {3.8072913984941516`*^9, 3.8072915033265676`*^9}, {
   3.8072915453896227`*^9, 3.8072915723502183`*^9}, {3.8072916064607916`*^9, 
   3.8072916533003054`*^9}, {3.80729168730206*^9, 3.807291754977564*^9}, {
   3.807291794409362*^9, 3.807291837991747*^9}, {3.807291885025274*^9, 
   3.8072919372664614`*^9}, {3.8072919782365932`*^9, 3.8072920837359004`*^9}, 
   3.8072921148969*^9, {3.807292166549877*^9, 3.8072922358885565`*^9}, {
   3.807292272751108*^9, 3.8072923719046617`*^9}, {3.807292406680128*^9, 
   3.8072924872910414`*^9}, {3.8072925630324583`*^9, 
   3.8072926142323914`*^9}, {3.8072926777286453`*^9, 
   3.8072927124909945`*^9}, {3.8072929224663897`*^9, 
   3.8072930856053104`*^9}, {3.807293150960889*^9, 3.8072933259559135`*^9}, {
   3.807293372896434*^9, 3.80729337577271*^9}, {3.807293498149501*^9, 
   3.80729350530119*^9}, {3.8072937013582354`*^9, 3.8072937344304104`*^9}, {
   3.8072943413831043`*^9, 3.807294387311715*^9}}],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {"N", "x1", "x2", "x3", "x4", "e1", "e2", "e3", "e4"},
    {"0", "0.985294`", 
     RowBox[{"-", "1"}], 
     RowBox[{"-", "0.17143`"}], 
     "1.285714`", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>"},
    {"1", "1.10672042101`", 
     RowBox[{"-", "0.7341767887699999`"}], "0.45682098491400003`", 
     "1.414134879532`", "0.0065480662228665915`", "0.014334837313254483`", 
     "0.03387919218552314`", "0.006925250835689674`"},
    {"2", "1.384274796728693`", 
     RowBox[{"-", "0.9449337408272596`"}], "0.6336558594913976`", 
     "1.4439335860649853`", "0.014967454508955053`", "0.011365322864014937`", 
     "0.009536033917607994`", "0.0016069311943047952`"},
    {"3", "1.5595527864406407`", 
     RowBox[{"-", "0.9544744590124036`"}], "0.620160134297075`", 
     "1.4912328063381544`", "0.009452077023255444`", "0.0005144947365687874`",
      "0.0007277732602425629`", "0.002550667507635413`"},
    {"4", "1.5504690297182893`", 
     RowBox[{"-", "0.9135613256589022`"}], "0.6674657022339616`", 
     "1.4989102595763877`", "0.0004898525384806332`", "0.002206290067312747`",
      "0.002551009813058219`", "0.00041401592675430367`"},
    {"5", "1.5644755794564937`", 
     RowBox[{"-", "0.9331589506540081`"}], "0.6837952688843212`", 
     "1.4982879881210889`", "0.0007553200899504772`", 
     "0.0010568255673803532`", "0.0008805915790638544`", 
     "0.00003355673883825158`"},
    {"6", "1.5810049546137883`", 
     RowBox[{"-", "0.936417568431692`"}], "0.6790263417346742`", 
     "1.5021501602591438`", "0.0008913664938181552`", 
     "0.00017572489435002935`", "0.00025717014903488673`", 
     "0.0002082722912669178`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  TableForm[{{
    N, $CellContext`x1, $CellContext`x2, $CellContext`x3, $CellContext`x4, \
$CellContext`e1, $CellContext`e2, $CellContext`e3, $CellContext`e4}, {
    0, 0.985294, -1, -0.17143, 1.285714}, {
    1, 1.10672042101, -0.7341767887699999, 0.45682098491400003`, 
     1.414134879532, 0.0065480662228665915`, 0.014334837313254483`, 
     0.03387919218552314, 0.006925250835689674}, {
    2, 1.384274796728693, -0.9449337408272596, 0.6336558594913976, 
     1.4439335860649853`, 0.014967454508955053`, 0.011365322864014937`, 
     0.009536033917607994, 0.0016069311943047952`}, {
    3, 1.5595527864406407`, -0.9544744590124036, 0.620160134297075, 
     1.4912328063381544`, 0.009452077023255444, 0.0005144947365687874, 
     0.0007277732602425629, 0.002550667507635413}, {
    4, 1.5504690297182893`, -0.9135613256589022, 0.6674657022339616, 
     1.4989102595763877`, 0.0004898525384806332, 0.002206290067312747, 
     0.002551009813058219, 0.00041401592675430367`}, {
    5, 1.5644755794564937`, -0.9331589506540081, 0.6837952688843212, 
     1.4982879881210889`, 0.0007553200899504772, 0.0010568255673803532`, 
     0.0008805915790638544, 0.00003355673883825158}, {
    6, 1.5810049546137883`, -0.936417568431692, 0.6790263417346742, 
     1.5021501602591438`, 0.0008913664938181552, 0.00017572489435002935`, 
     0.00025717014903488673`, 0.0002082722912669178}}]]], "Output",
 CellChangeTimes->{
  3.8072903434400187`*^9, {3.807290710790182*^9, 3.807290740050995*^9}, 
   3.807290880417818*^9, {3.8072909503015537`*^9, 3.807291041815366*^9}, 
   3.8072916593808885`*^9, {3.8072917330224557`*^9, 3.8072917568077393`*^9}, 
   3.8072918003899393`*^9, 3.807291839818918*^9, 3.8072919844151864`*^9, {
   3.8072920678973694`*^9, 3.80729208531505*^9}, 3.807292532986565*^9, 
   3.807292619496035*^9, {3.8072926903798647`*^9, 3.807292715671301*^9}, 
   3.8072930875524983`*^9, {3.8072933057849684`*^9, 3.807293328089121*^9}, 
   3.8072935099106345`*^9, {3.8072937142837324`*^9, 3.8072937381103134`*^9}, 
   3.807294390565172*^9}]
}, Open  ]]
},
WindowSize->{961, 872},
WindowMargins->{{49, Automatic}, {Automatic, 20}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 11007, 233, 1032, "Input"],
Cell[11590, 257, 4129, 75, 146, "Output"]
}, Open  ]]
}
]
*)

